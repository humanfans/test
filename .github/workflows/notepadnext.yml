name: linyaps-notepadnext

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v5

      - name: ğŸ”§ æ·»åŠ  Linglong APT æº
        run:  'wget https://gitee.com/LFRon/Linyaps-generic-linux-SIG/releases/download/1.9.12/ubuntu-24.04-x86_64.tar.gz'
      - name: ğŸ”§ æ·»åŠ  Linglong APT æº
        run: 'tar -zxvf ubuntu-24.04-x86_64.tar.gz'
      - name: ğŸ“¦ æ›´æ–°å¹¶å®‰è£… Linglong å·¥å…·
        run: sudo apt install ./*deb
      #- #name: æŸ¥çœ‹å½“å‰ç›®å½•
        #run: 'll-cli install org.deepin.base'
      - name: ç¼–è¯‘notepad
        run: ll-builder build
      - name: å¯¼å‡ºäºŒè¿›åˆ¶æ–‡ä»¶
        run: ll-builder export --layer
        
      - name: æ‰¾å‡ºç”Ÿæˆçš„ layer æ–‡ä»¶å¹¶é‡å‘½åï¼ˆå¯é€‰ï¼‰
        id: find_layer
        run: |
          LAYER_FILE=$(find . -type f -name "*.layer" | head -n 1)
          echo "FOUND_LAYER=$LAYER_FILE" >> $GITHUB_ENV
          echo "LAYER_FILENAME=${LAYER_FILE##*/}" >> $GITHUB_ENV

      # åªåœ¨ push åˆ° main åˆ†æ”¯æ—¶å‘å¸ƒ
      - name: ğŸš€ å‘å¸ƒåˆ° GitHub Release
        if: github.event_name == 'push'
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ github.ref }}
          name: Release ${{ github.sha }}
          draft: false
          prerelease: false
          files: ${{ env.FOUND_LAYER }}
